<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LSL Interactive Class</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Chart Container Styling */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
            max-height: 500px;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }

        /* Syntax Highlighting Mock */
        .code-keyword { color: #d73a49; font-weight: bold; }
        .code-type { color: #005cc5; }
        .code-string { color: #032f62; }
        .code-function { color: #6f42c1; }
        .code-comment { color: #6a737d; font-style: italic; }
        
        .nav-active {
            border-bottom: 2px solid #2563eb;
            color: #1e3a8a;
            font-weight: 600;
        }
    </style>
    <!-- Chosen Palette: Slate & Blue - 'Warm Neutral' background (Slate-50) with professional Blue (Blue-600) accents for a calm, technical feel. -->
    <!-- Application Structure Plan:
         1. Header: Quick context.
         2. Concept Visualizer: Interactive breakdown of State/Event architecture (Core Architecture).
         3. Data Type Explorer: Grid with filtering for types (Fundamental Data Types).
         4. Code Lab: Interactive snippet that explains lines on hover (Basic Script Skeleton).
         5. Knowledge Graph: Chart.js visualization of concept difficulty vs importance (Analysis).
         6. Reference Deck: Tabbed view for Functions vs Events with search (Essential Events/Key Functions).
         7. Mastery Path: Timeline for the learning levels (Recommended Learning Path).
         Rationale: Breaks the text-heavy guide into functional modules. Users learn the 'what' (types), then the 'how' (logic), then the 'tools' (functions), and finally the 'path' (roadmap). 
    -->
    <!-- Visualization & Content Choices:
         - Concept Matrix (Chart.js): Scatter plot to show 'Difficulty' vs 'Frequency of Use'. Helps learners manage expectations (e.g., Rotations are hard but rare for beginners).
         - Interactive Code Block: HTML/JS hover effects. Essential for coding guides to link syntax to meaning.
         - Filterable Grids: For Data Types and Functions. Allows quick lookup.
         - Timeline: Vertical layout for Learning Path. logical progression.
         - NO SVG/Mermaid: All icons are Unicode or CSS shapes. Charts are Canvas.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-slate-50 text-slate-800 font-sans leading-relaxed">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-white/90 backdrop-blur-md shadow-sm border-b border-slate-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex-shrink-0 flex items-center gap-2 cursor-pointer" onclick="scrollToSection('hero')">
                    <span class="text-2xl">⚡</span>
                    <span class="font-bold text-xl tracking-tight text-slate-900">LSL <span class="text-blue-600">Mastery</span></span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <button onclick="scrollToSection('concepts')" class="nav-item text-slate-600 hover:text-blue-600 px-3 py-2 text-sm font-medium transition-colors">Core Concepts</button>
                    <button onclick="scrollToSection('datatypes')" class="nav-item text-slate-600 hover:text-blue-600 px-3 py-2 text-sm font-medium transition-colors">Data Types</button>
                    <button onclick="scrollToSection('analysis')" class="nav-item text-slate-600 hover:text-blue-600 px-3 py-2 text-sm font-medium transition-colors">Analysis</button>
                    <button onclick="scrollToSection('reference')" class="nav-item text-slate-600 hover:text-blue-600 px-3 py-2 text-sm font-medium transition-colors">Reference</button>
                    <button onclick="scrollToSection('roadmap')" class="nav-item text-slate-600 hover:text-blue-600 px-3 py-2 text-sm font-medium transition-colors">Roadmap</button>
                </div>
                <!-- Mobile menu button placeholder -->
                <div class="md:hidden">
                    <button onclick="toggleMobileMenu()" class="text-slate-600 hover:text-blue-600">☰</button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-slate-200">
             <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <button onclick="scrollToSection('concepts')" class="block w-full text-left px-3 py-2 text-base font-medium text-slate-600 hover:bg-slate-50 hover:text-blue-600">Core Concepts</button>
                <button onclick="scrollToSection('datatypes')" class="block w-full text-left px-3 py-2 text-base font-medium text-slate-600 hover:bg-slate-50 hover:text-blue-600">Data Types</button>
                <button onclick="scrollToSection('analysis')" class="block w-full text-left px-3 py-2 text-base font-medium text-slate-600 hover:bg-slate-50 hover:text-blue-600">Analysis</button>
                <button onclick="scrollToSection('reference')" class="block w-full text-left px-3 py-2 text-base font-medium text-slate-600 hover:bg-slate-50 hover:text-blue-600">Reference</button>
             </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header id="hero" class="relative overflow-hidden bg-white pt-16 pb-24">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="text-center">
                <h1 class="text-4xl tracking-tight font-extrabold text-slate-900 sm:text-5xl md:text-6xl">
                    <span class="block">Linden Scripting Language</span>
                    <span class="block text-blue-600">Interactive Study Guide</span>
                </h1>
                <p class="mt-3 max-w-md mx-auto text-base text-slate-500 sm:text-lg md:mt-5 md:text-xl md:max-w-3xl">
                    Master the State-Event architecture, understand strict typing, and build interactive virtual objects. This guide transforms static documentation into an explorable developer workspace.
                </p>
                <div class="mt-5 max-w-md mx-auto sm:flex sm:justify-center md:mt-8">
                    <div class="rounded-md shadow">
                        <button onclick="scrollToSection('concepts')" class="w-full flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 md:py-4 md:text-lg md:px-10 transition-all">
                            Start Learning
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Module 1: Core Concepts (State-Event Model) -->
    <section id="concepts" class="py-16 bg-slate-50 border-t border-slate-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-extrabold text-slate-900">Core Architecture</h2>
                <p class="mt-4 text-lg text-slate-600 max-w-3xl mx-auto">
                    LSL is unique because it is <strong>State-Based</strong> and <strong>Event-Driven</strong>. A script waits in a specific 'State' until an 'Event' triggers it. Explore the interactive skeleton below to understand the flow.
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start">
                <!-- Interactive Code Skeleton -->
                <div class="bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden">
                    <div class="bg-slate-100 px-4 py-2 border-b border-slate-200 flex justify-between items-center">
                        <span class="text-xs font-mono text-slate-500">script.lsl</span>
                        <span class="text-xs font-bold text-blue-600">Read-Only</span>
                    </div>
                    <div class="p-6 font-mono text-sm leading-loose overflow-x-auto">
                        <div class="group hover:bg-blue-50 cursor-help p-1 rounded transition-colors" onmouseover="updateContext('default')" onclick="updateContext('default')">
                            <span class="code-keyword">default</span>
                        </div>
                        <div class="text-slate-800">{</div>
                        
                        <div class="pl-4 group hover:bg-blue-50 cursor-help p-1 rounded transition-colors" onmouseover="updateContext('state_entry')" onclick="updateContext('state_entry')">
                            <span class="code-function">state_entry</span>()
                        </div>
                        <div class="pl-4 text-slate-800">{</div>
                        <div class="pl-8 group hover:bg-blue-50 cursor-help p-1 rounded transition-colors" onmouseover="updateContext('llSay')" onclick="updateContext('llSay')">
                            <span class="code-comment">// Runs on start</span><br>
                            <span class="code-function">llSay</span>(0, <span class="code-string">"Hello, World!"</span>);
                        </div>
                        <div class="pl-4 text-slate-800">}</div>
                        <br>
                        <div class="pl-4 group hover:bg-blue-50 cursor-help p-1 rounded transition-colors" onmouseover="updateContext('touch_start')" onclick="updateContext('touch_start')">
                            <span class="code-function">touch_start</span>(<span class="code-type">integer</span> total_number)
                        </div>
                        <div class="pl-4 text-slate-800">{</div>
                        <div class="pl-8 group hover:bg-blue-50 cursor-help p-1 rounded transition-colors" onmouseover="updateContext('llDetected')" onclick="updateContext('llDetected')">
                            <span class="code-comment">// Runs on click</span><br>
                            <span class="code-function">llSay</span>(0, <span class="code-string">"Touched by "</span> + <span class="code-function">llDetectedName</span>(0));
                        </div>
                        <div class="pl-4 text-slate-800">}</div>
                        
                        <div class="text-slate-800">}</div>
                    </div>
                </div>

                <!-- Context Panel -->
                <div class="bg-white rounded-xl shadow-lg border border-slate-200 p-8 h-full flex flex-col justify-center">
                    <div id="context-display" class="transition-all duration-300">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 text-xl">ℹ️</div>
                            <h3 id="ctx-title" class="text-xl font-bold text-slate-900">Hover over the code</h3>
                        </div>
                        <p id="ctx-desc" class="text-slate-600">
                            Move your mouse over the code blocks on the left to understand how the State-Event architecture functions line by line.
                        </p>
                        <div id="ctx-extra" class="mt-6 p-4 bg-slate-50 rounded-lg border border-slate-200 text-sm text-slate-500 hidden">
                            <!-- Dynamic content will appear here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Module 2: Data Types (Filterable Grid) -->
    <section id="datatypes" class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-extrabold text-slate-900">Fundamental Data Types</h2>
                <p class="mt-4 text-lg text-slate-600">LSL uses strict typing. Filter the types below to understand their constraints and usage.</p>
                
                <!-- Filters -->
                <div class="mt-6 flex flex-wrap justify-center gap-2">
                    <button onclick="filterTypes('all')" class="type-filter active-filter px-4 py-2 rounded-full text-sm font-medium bg-blue-100 text-blue-700 hover:bg-blue-200 transition-colors">All</button>
                    <button onclick="filterTypes('number')" class="type-filter px-4 py-2 rounded-full text-sm font-medium bg-slate-100 text-slate-600 hover:bg-slate-200 transition-colors">Numbers</button>
                    <button onclick="filterTypes('text')" class="type-filter px-4 py-2 rounded-full text-sm font-medium bg-slate-100 text-slate-600 hover:bg-slate-200 transition-colors">Text & ID</button>
                    <button onclick="filterTypes('complex')" class="type-filter px-4 py-2 rounded-full text-sm font-medium bg-slate-100 text-slate-600 hover:bg-slate-200 transition-colors">Complex</button>
                </div>
            </div>

            <div id="types-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Cards injected via JS -->
            </div>
        </div>
    </section>

    <!-- Module 3: Analysis (Chart.js) -->
    <section id="analysis" class="py-16 bg-slate-50 border-t border-slate-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
                <div class="lg:col-span-1">
                    <h2 class="text-3xl font-extrabold text-slate-900 mb-6">Concept Strategy</h2>
                    <p class="text-slate-600 mb-6">
                        Not all LSL concepts are created equal. This analysis plots the concepts based on <strong>Learning Curve</strong> (Difficulty) versus <strong>Frequency of Use</strong>.
                    </p>
                    <ul class="space-y-4">
                        <li class="flex items-start">
                            <span class="flex-shrink-0 h-6 w-6 rounded-full bg-green-100 flex items-center justify-center text-green-600 text-xs font-bold mt-0.5">1</span>
                            <span class="ml-3 text-slate-600"><strong>Start Here:</strong> High frequency, low difficulty items like Integers and Strings.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="flex-shrink-0 h-6 w-6 rounded-full bg-yellow-100 flex items-center justify-center text-yellow-600 text-xs font-bold mt-0.5">2</span>
                            <span class="ml-3 text-slate-600"><strong>Core Skills:</strong> States and basic Events are moderate difficulty but essential.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="flex-shrink-0 h-6 w-6 rounded-full bg-red-100 flex items-center justify-center text-red-600 text-xs font-bold mt-0.5">3</span>
                            <span class="ml-3 text-slate-600"><strong>Advanced:</strong> Rotations are powerful but strictly for advanced users (Level 4).</span>
                        </li>
                    </ul>
                </div>
                
                <div class="lg:col-span-2 flex flex-col items-center">
                    <div class="chart-container bg-white p-4 rounded-xl shadow-md border border-slate-200">
                        <canvas id="conceptChart"></canvas>
                    </div>
                    <p class="text-xs text-slate-400 mt-2">Data extrapolated from study guide structure levels.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Module 4: Reference Hub (Tabs) -->
    <section id="reference" class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-extrabold text-slate-900 text-center mb-8">Essential Toolset</h2>
            
            <div class="max-w-4xl mx-auto">
                <!-- Tab Headers -->
                <div class="flex border-b border-slate-200 mb-6">
                    <button onclick="switchTab('events')" id="tab-btn-events" class="flex-1 py-4 text-center text-lg font-medium text-blue-600 border-b-2 border-blue-600 hover:text-blue-800 transition-colors focus:outline-none">
                        Events (Triggers)
                    </button>
                    <button onclick="switchTab('functions')" id="tab-btn-functions" class="flex-1 py-4 text-center text-lg font-medium text-slate-500 hover:text-slate-700 transition-colors focus:outline-none">
                        Functions (Actions)
                    </button>
                    <button onclick="switchTab('tips')" id="tab-btn-tips" class="flex-1 py-4 text-center text-lg font-medium text-slate-500 hover:text-slate-700 transition-colors focus:outline-none">
                        Workflow & Tips
                    </button>
                </div>

                <!-- Tab Content: Events -->
                <div id="tab-content-events" class="tab-content animate-fade-in space-y-4">
                    <p class="text-slate-600 mb-4">Events are triggers that happen within a state. Without events, a script does nothing.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="events-list">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- Tab Content: Functions -->
                <div id="tab-content-functions" class="hidden tab-content animate-fade-in space-y-4">
                    <p class="text-slate-600 mb-4">Functions are the built-in commands starting with <code>ll</code>. They perform the actions.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="functions-list">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- Tab Content: Tips -->
                <div id="tab-content-tips" class="hidden tab-content animate-fade-in">
                    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4">
                        <div class="flex">
                            <div class="flex-shrink-0">⚠️</div>
                            <div class="ml-3">
                                <p class="text-sm text-yellow-700">
                                    <strong>Memory Limit:</strong> Mono-compiled scripts have a 64KB limit. Be mindful of large lists!
                                </p>
                            </div>
                        </div>
                    </div>
                    <ul class="space-y-4">
                        <li class="bg-slate-50 p-4 rounded-lg border border-slate-200">
                            <h4 class="font-bold text-slate-800">1. The Built-in Editor</h4>
                            <p class="text-sm text-slate-600">Right-click Object > Edit > Content > New Script.</p>
                        </li>
                        <li class="bg-slate-50 p-4 rounded-lg border border-slate-200">
                            <h4 class="font-bold text-slate-800">2. Compiling</h4>
                            <p class="text-sm text-slate-600">Click "Save" to check for syntax errors. Highlights specific lines if an error is found.</p>
                        </li>
                        <li class="bg-slate-50 p-4 rounded-lg border border-slate-200">
                            <h4 class="font-bold text-slate-800">3. Coordinate Systems</h4>
                            <p class="text-sm text-slate-600">Global vs Local. Note: Color vectors are 0.0 to 1.0 (float), not 0-255.</p>
                        </li>
                        <li class="bg-slate-50 p-4 rounded-lg border border-slate-200">
                            <h4 class="font-bold text-slate-800">4. Linkset Data (LSD)</h4>
                            <p class="text-sm text-slate-600">Use this modern feature for storing data across multiple scripts. Faster than Link Messages.</p>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Module 5: Roadmap (Timeline) -->
    <section id="roadmap" class="py-16 bg-slate-900 text-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-extrabold text-white">Recommended Learning Path</h2>
                <p class="mt-4 text-lg text-slate-400">Follow this step-by-step progression to build your skills.</p>
            </div>

            <div class="relative max-w-2xl mx-auto">
                <div class="absolute left-1/2 w-0.5 h-full bg-slate-700 transform -translate-x-1/2"></div>
                
                <!-- Level 1 -->
                <div class="relative z-10 mb-8 w-full flex items-center justify-between group">
                    <div class="order-1 w-5/12 text-right pr-8">
                        <h3 class="text-xl font-bold text-blue-400">Level 1: Color Changer</h3>
                        <p class="text-sm text-slate-400 mt-1">Change color on <code>touch_start</code>.</p>
                    </div>
                    <div class="order-1 w-8 h-8 bg-slate-900 border-2 border-blue-500 rounded-full flex items-center justify-center text-xs font-bold shadow-[0_0_15px_rgba(59,130,246,0.5)]">1</div>
                    <div class="order-1 w-5/12 pl-8 opacity-50 text-xs">Basic Event Handling</div>
                </div>

                <!-- Level 2 -->
                <div class="relative z-10 mb-8 w-full flex items-center justify-between group">
                    <div class="order-1 w-5/12 text-right pr-8 opacity-50 text-xs">Interactivity & Detection</div>
                    <div class="order-1 w-8 h-8 bg-slate-900 border-2 border-green-500 rounded-full flex items-center justify-center text-xs font-bold shadow-[0_0_15px_rgba(34,197,94,0.5)]">2</div>
                    <div class="order-1 w-5/12 pl-8">
                        <h3 class="text-xl font-bold text-green-400">Level 2: Greeting Bot</h3>
                        <p class="text-sm text-slate-400 mt-1">Use <code>sensor</code> to detect avatars and <code>llSay</code> to greet them.</p>
                    </div>
                </div>

                <!-- Level 3 -->
                <div class="relative z-10 mb-8 w-full flex items-center justify-between group">
                    <div class="order-1 w-5/12 text-right pr-8">
                        <h3 class="text-xl font-bold text-yellow-400">Level 3: Timed Light</h3>
                        <p class="text-sm text-slate-400 mt-1">Use <code>timer</code> to switch between "On" and "Off" states.</p>
                    </div>
                    <div class="order-1 w-8 h-8 bg-slate-900 border-2 border-yellow-500 rounded-full flex items-center justify-center text-xs font-bold shadow-[0_0_15px_rgba(234,179,8,0.5)]">3</div>
                    <div class="order-1 w-5/12 pl-8 opacity-50 text-xs">State Switching Logic</div>
                </div>

                <!-- Level 4 -->
                <div class="relative z-10 w-full flex items-center justify-between group">
                    <div class="order-1 w-5/12 text-right pr-8 opacity-50 text-xs">Advanced Mathematics</div>
                    <div class="order-1 w-8 h-8 bg-slate-900 border-2 border-red-500 rounded-full flex items-center justify-center text-xs font-bold shadow-[0_0_15px_rgba(239,68,68,0.5)]">4</div>
                    <div class="order-1 w-5/12 pl-8">
                        <h3 class="text-xl font-bold text-red-400">Level 4: Rotations</h3>
                        <p class="text-sm text-slate-400 mt-1">Master Quaternions. The steepest learning curve.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="bg-white border-t border-slate-200 py-8">
        <div class="max-w-7xl mx-auto px-4 text-center text-slate-500">
            <p>&copy; 2023 LSL Study Guide Interactive. Based on Linden Scripting Language documentation.</p>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // Data Store
        const appData = {
            dataTypes: [
                { type: 'integer', cat: 'number', desc: 'Whole numbers (32-bit).', ex: '10, -5' },
                { type: 'float', cat: 'number', desc: 'Decimal numbers.', ex: '3.14159, 1.0' },
                { type: 'string', cat: 'text', desc: 'Text enclosed in double quotes.', ex: '"Hello"' },
                { type: 'key', cat: 'text', desc: 'Unique UUID string (128-bit).', ex: '"0000-..."' },
                { type: 'vector', cat: 'complex', desc: '3D coordinates/colors <x, y, z>.', ex: '<1.0, 0.5, 0.0>' },
                { type: 'rotation', cat: 'complex', desc: 'Quaternions <x, y, z, s>.', ex: 'ZERO_ROTATION' },
                { type: 'list', cat: 'complex', desc: 'Collection of other types.', ex: '[1, "text", <0,0,0>]' }
            ],
            events: [
                { name: 'state_entry', desc: 'Initialization. Runs when script starts or enters the state.' },
                { name: 'touch_start', desc: 'Interaction. Runs when user clicks the object.' },
                { name: 'timer', desc: 'Time-based. Runs repeatedly at set frequency.' },
                { name: 'listen', desc: 'Chat. Runs when object hears text on specific channel.' },
                { name: 'sensor', desc: 'Detection. Scans for nearby avatars/objects.' },
                { name: 'http_response', desc: 'Web. Communication with external websites.' }
            ],
            functions: [
                { name: 'llSay', category: 'Communication', sig: '(channel, message)' },
                { name: 'llOwnerSay', category: 'Communication', sig: '(message)' },
                { name: 'llRegionSay', category: 'Communication', sig: '(channel, message)' },
                { name: 'llSetPos', category: 'Movement', sig: '(vector)' },
                { name: 'llTargetOmega', category: 'Movement', sig: '(axis, spin, gain)' },
                { name: 'llSetColor', category: 'Appearance', sig: '(color, face)' },
                { name: 'llSetTexture', category: 'Appearance', sig: '(name, face)' },
                { name: 'llGetOwner', category: 'Utility', sig: '()' },
                { name: 'llDie', category: 'Utility', sig: '()' },
                { name: 'llGetPos', category: 'Utility', sig: '()' }
            ],
            contextInfo: {
                'default': { title: "The 'default' State", desc: "Every script MUST have a default state. It is the entry point. A script is always in one state at a time." },
                'state_entry': { title: "state_entry() Event", desc: "This event triggers automatically the moment the script enters this state. Use it to set up initial properties like color or timers." },
                'llSay': { title: "llSay(channel, msg)", desc: "A built-in function to make the object speak. Channel 0 is public chat." },
                'touch_start': { title: "touch_start(num)", desc: "This event waits for a user to click the object. It will not run until someone clicks." },
                'llDetected': { title: "llDetectedName(0)", desc: "Retrieves the name of the 0th (first) person who touched the object." }
            }
        };

        // --- Core Functions ---

        function init() {
            renderDataTypes('all');
            renderReferenceLists();
            initChart();
        }

        // 1. Navigation & Scrolling
        function scrollToSection(id) {
            const el = document.getElementById(id);
            if (el) {
                el.scrollIntoView({ behavior: 'smooth' });
            }
            // Close mobile menu if open
            const mobileMenu = document.getElementById('mobile-menu');
            if(!mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.add('hidden');
            }
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        }

        // 2. Code Context Viewer
        function updateContext(key) {
            const display = document.getElementById('context-display');
            const title = document.getElementById('ctx-title');
            const desc = document.getElementById('ctx-desc');
            const extra = document.getElementById('ctx-extra');

            if (appData.contextInfo[key]) {
                const info = appData.contextInfo[key];
                title.innerText = info.title;
                desc.innerText = info.desc;
                display.classList.add('bg-blue-50');
                setTimeout(() => display.classList.remove('bg-blue-50'), 300);
            }
        }

        // 3. Data Type Filter
        function filterTypes(category) {
            renderDataTypes(category);
            
            // Update active button state
            document.querySelectorAll('.type-filter').forEach(btn => {
                if ((category === 'all' && btn.innerText === 'All') || 
                    (category === 'number' && btn.innerText.includes('Numbers')) ||
                    (category === 'text' && btn.innerText.includes('Text')) ||
                    (category === 'complex' && btn.innerText.includes('Complex'))) {
                    btn.classList.add('bg-blue-100', 'text-blue-700', 'active-filter');
                    btn.classList.remove('bg-slate-100', 'text-slate-600');
                } else {
                    btn.classList.remove('bg-blue-100', 'text-blue-700', 'active-filter');
                    btn.classList.add('bg-slate-100', 'text-slate-600');
                }
            });
        }

        function renderDataTypes(category) {
            const grid = document.getElementById('types-grid');
            grid.innerHTML = '';
            
            const filtered = category === 'all' 
                ? appData.dataTypes 
                : appData.dataTypes.filter(d => d.cat === category);

            filtered.forEach(item => {
                const card = document.createElement('div');
                card.className = "bg-slate-50 rounded-xl p-6 border border-slate-200 hover:shadow-md transition-shadow group";
                card.innerHTML = `
                    <div class="text-xs font-bold uppercase tracking-wider text-slate-400 mb-1">${item.cat}</div>
                    <div class="text-xl font-bold text-blue-600 font-mono mb-2">${item.type}</div>
                    <p class="text-slate-600 text-sm mb-4 min-h-[40px]">${item.desc}</p>
                    <div class="bg-white p-2 rounded border border-slate-200 text-xs font-mono text-slate-500">
                        Ex: <span class="text-slate-800">${item.ex}</span>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        // 4. Reference Tabs
        function switchTab(tabName) {
            // Hide all contents
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            // Show selected
            document.getElementById(`tab-content-${tabName}`).classList.remove('hidden');

            // Reset buttons
            const buttons = ['events', 'functions', 'tips'];
            buttons.forEach(btn => {
                const el = document.getElementById(`tab-btn-${btn}`);
                if (btn === tabName) {
                    el.classList.add('text-blue-600', 'border-b-2', 'border-blue-600');
                    el.classList.remove('text-slate-500');
                } else {
                    el.classList.remove('text-blue-600', 'border-b-2', 'border-blue-600');
                    el.classList.add('text-slate-500');
                }
            });
        }

        function renderReferenceLists() {
            // Render Events
            const eventsList = document.getElementById('events-list');
            appData.events.forEach(evt => {
                const div = document.createElement('div');
                div.className = "p-4 border border-slate-200 rounded-lg bg-slate-50 hover:bg-white hover:border-blue-300 transition-all";
                div.innerHTML = `<h4 class="font-bold text-slate-800 font-mono text-lg mb-1">${evt.name}()</h4><p class="text-sm text-slate-600">${evt.desc}</p>`;
                eventsList.appendChild(div);
            });

            // Render Functions
            const funcList = document.getElementById('functions-list');
            appData.functions.forEach(fn => {
                const div = document.createElement('div');
                div.className = "p-4 border border-slate-200 rounded-lg bg-slate-50 hover:bg-white hover:border-blue-300 transition-all flex justify-between items-center";
                div.innerHTML = `
                    <div>
                        <span class="text-xs font-bold text-slate-400 uppercase mr-2">${fn.category}</span>
                        <h4 class="font-bold text-slate-800 font-mono inline">${fn.name}</h4>
                        <span class="text-slate-500 font-mono text-sm">${fn.sig}</span>
                    </div>
                `;
                funcList.appendChild(div);
            });
        }

        // 5. Chart.js Visualization
        function initChart() {
            const ctx = document.getElementById('conceptChart').getContext('2d');
            
            // Data points: x = Frequency (Usefulness), y = Difficulty
            // Integers/Strings: High Freq (9), Low Diff (1)
            // States: Med Freq (7), Med Diff (4)
            // Events: High Freq (8), Med Diff (3)
            // Rotations: Low Freq (3), High Diff (9)
            // Sensors: Med Freq (5), Med Diff (5)
            // LSD: Med Freq (6), Med Diff (6)

            const scatterData = {
                datasets: [{
                    label: 'LSL Concepts',
                    data: [
                        { x: 9, y: 1, label: 'Ints/Strings' },
                        { x: 8, y: 3, label: 'Events' },
                        { x: 7, y: 4, label: 'States' },
                        { x: 5, y: 5, label: 'Sensors' },
                        { x: 6, y: 6, label: 'LSD (Link Data)' },
                        { x: 3, y: 9, label: 'Rotations' }
                    ],
                    backgroundColor: function(context) {
                        const val = context.raw?.y;
                        return val > 7 ? 'rgba(239, 68, 68, 0.8)' : // Red for hard
                               val > 4 ? 'rgba(234, 179, 8, 0.8)' : // Yellow for med
                               'rgba(34, 197, 94, 0.8)'; // Green for easy
                    },
                    pointRadius: 10,
                    pointHoverRadius: 12
                }]
            };

            new Chart(ctx, {
                type: 'scatter',
                data: scatterData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.raw.label}: Diff ${context.raw.y}/10, Freq ${context.raw.x}/10`;
                                }
                            }
                        },
                        legend: { display: false },
                        title: {
                            display: true,
                            text: 'Difficulty vs. Frequency of Use',
                            font: { size: 16 }
                        }
                    },
                    scales: {
                        x: {
                            title: { display: true, text: 'Frequency of Use (Relevance)' },
                            min: 0, max: 10
                        },
                        y: {
                            title: { display: true, text: 'Learning Difficulty' },
                            min: 0, max: 10
                        }
                    }
                }
            });
        }

        // Initialize App
        window.addEventListener('DOMContentLoaded', init);

    </script>
</body>
</html>
